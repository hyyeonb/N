<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dev3.nms.mapper.VendorMapper">

    <select id="findAllVendors" resultType="dev3.nms.vo.mgmt.VendorVO">
        SELECT
            v.VENDOR_ID,
            v.VENDOR_NAME,
            v.VENDOR_BASE_OID,
            v.CREATE_AT
        FROM
            r_vendor_t v
        WHERE EXISTS (
            SELECT 1 FROM r_model_t m WHERE m.VENDOR_ID = v.VENDOR_ID AND m.DELETE_AT IS NULL
        )
        ORDER BY v.VENDOR_NAME
    </select>

    <select id="findVendorById" resultType="dev3.nms.vo.mgmt.VendorVO">
        SELECT
            VENDOR_ID,
            VENDOR_NAME,
            VENDOR_BASE_OID,
            CREATE_AT
        FROM
            r_vendor_t
        WHERE
            VENDOR_ID = #{vendorId}
    </select>

    <select id="findVendorByOid" resultType="dev3.nms.vo.mgmt.VendorVO">
        SELECT
            VENDOR_ID,
            VENDOR_NAME,
            VENDOR_BASE_OID,
            CREATE_AT
        FROM
            r_vendor_t
        WHERE
            #{oid} LIKE CONCAT(VENDOR_BASE_OID, '%')
        ORDER BY LENGTH(VENDOR_BASE_OID) DESC
        LIMIT 1
    </select>

    <select id="findVendorByBaseOid" resultType="dev3.nms.vo.mgmt.VendorVO">
        SELECT
            VENDOR_ID,
            VENDOR_NAME,
            VENDOR_BASE_OID,
            CREATE_AT
        FROM
            r_vendor_t
        WHERE
            VENDOR_BASE_OID = #{baseOid}
    </select>

    <!-- 모든 벤더 조회 (모델 유무 상관없이) -->
    <select id="findAllVendorsUnfiltered" resultType="dev3.nms.vo.mgmt.VendorVO">
        SELECT
            VENDOR_ID,
            VENDOR_NAME,
            VENDOR_BASE_OID,
            CREATE_AT
        FROM
            r_vendor_t
        ORDER BY VENDOR_NAME
    </select>

</mapper>
